<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>LoanFlow | Home</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="animation/aos.css">
    <link rel="stylesheet" type="text/css" href="assets/css/client-chat.css">

    <link rel="stylesheet" type="text/css" href="css/style.css">
    <link rel="stylesheet" type="text/css" href="css/responsive.css">
</head>
<body>
  <div class="wrapper">
    <header class="header">
      <nav class="navbar navbar-expand-lg">
        <div class="container">
          <a class="navbar-brand" href="index.html"><img src="images/logo.png" alt="logo"></a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse justify-content-between" id="navbarText">
            <ul class="navbar-nav w-100 justify-content-center">
              <li class="nav-item">
                <a class="nav-link" href="index.html">Home</a>
              </li>
              <li class="nav-item">
                <div class="dropdown">
                  <a class="nav-link" href="#service">Service</a>
                </div>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#howwework">How We Work?</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#aboutus">About Us</a>
              </li>
            </ul>
            <a href="application-step1.php" class="headertop-btn me-2">APPLY</a>
            <a href="login.html" class="headertop-btn-outline">LOGIN</a>
          </div>
        </div>
      </nav>
    </header>
    <div class="main">
      <div class="container">
        <div class="row justify-content-between align-items-center mt-100">
          <div class="col-lg-6 col-md-12" data-aos="fade-up-right">
            <h1 class="maintitle-text">Quick and Easy Loans for Your Financial Needs.</h1>
            <p class="subtitle-text">Our loan services offer a hassle-free and streamlined borrowing experience, providing you with the funds you need in a timely manner to meet your financial requirements.</p>
            <a href="application-step1.php" class="getstart-btn">Get started</a>
          </div>
          <div class="col-lg-6 col-md-12" data-aos="fade-up-left">
            <img src="images/hero-img.png" class="img-box">
          </div>
        </div>
      </div>
      <div class="service-bg mt-100" data-aos="fade-up" id="service">
        <div class="container">
          <h3 class="service-title mb-3">Our Services</h3>
          <div class="row">
            <div class="col-lg-4 mt-3">
              <div class="service-box">
                <img src="images/service-img-1.png" alt="">
                <h4>Personal loan</h4>
                <p>Personal loans provide borrowers with flexibility in how they use the funds.</p>
                <a href="application-step1.php">Apply now</a>
              </div>
            </div>
            <div class="col-lg-4 mt-3">
              <div class="service-box">
                <img src="images/service-img-2.png" alt="">
                <h4>Business loan</h4>
                <p>Business Loan Services provide financial assistance to businesses for various purposes..</p>
                <a href="application-step1.php">Apply now</a>
              </div>
            </div>
            <div class="col-lg-4 mt-3">
              <div class="service-box">
                <img src="images/service-img-3.png" alt="">
                <h4>Auto loan</h4>
                <p>Auto Loan Services provide financing options for individuals businesses to purchase a vehicle.</p>
                <a href="application-step1.php">Apply now</a>
              </div>
            </div>
          </div>
          <div class="text-center mt-4">
            <a href="resources.html" class="view-btn">View more</a>
          </div>
        </div>
      </div>
      <div class="mt-100" id="howwework">
        <div class="container">
          <div class="service-title">How we works ?</div>
          <p class="works-subtext text-center">This is a process, how you can get loan for your self.</p>
          <div class="row justify-content-around align-items-center mt-50 mobile-column">
            <div class="col-lg-5" data-aos="fade-up-right">
              <img src="images/works-img-1.png" alt="" class="img-box">
            </div>
            <div class="col-lg-6 position-relative" data-aos="fade-up-left">
              <h4 class="process-number">01</h4>
              <h3 class="works-text">Application</h3>
              <p class="works-subtext">The borrower submits a loan application to the bank, either in person, online, or through other channels. The application includes personal and financial information, such as income, employment history, credit score, and the purpose of the loan.</p>
            </div>
          </div>
          <div class="row justify-content-around align-items-center mt-50 pad-left">
            <div class="col-lg-6 position-relative" data-aos="fade-up-right">
              <h4 class="process-number">02</h4>
              <h3 class="works-text">Documentation and Verification</h3>
              <p class="works-subtext">The bank requests supporting documents from the borrower, such as identification proof, income statements, bank statements, and collateral details (if applicable). The bank verifies the information provided to assess the borrower's creditworthiness and eligibility for the loan.</p>
            </div>
            <div class="col-lg-5" data-aos="fade-up-left">
              <img src="images/works-img-2.png" alt="" class="img-box">
            </div>
          </div>
          <div class="row justify-content-around align-items-center mt-50 mobile-column">
            <div class="col-lg-5" data-aos="fade-up-right">
              <img src="images/works-img-3.png" alt="" class="img-box">
            </div>
            <div class="col-lg-6 position-relative" data-aos="fade-up-left">
              <h4 class="process-number">03</h4>
              <h3 class="works-text">Credit Assessment</h3>
              <p class="works-subtext">The bank conducts a credit assessment to evaluate the borrower's creditworthiness and ability to repay the loan. This process involves analyzing the borrower's credit history, income stability, debt-to-income ratio, and other factors.</p>
            </div>
          </div>
          <div class="row justify-content-around align-items-center mt-50 pad-left">
            <div class="col-lg-6 position-relative" data-aos="fade-up-right">
              <h4 class="process-number">04</h4>
              <h3 class="works-text">Loan Approval</h3>
              <p class="works-subtext">If the borrower meets the bank's lending criteria and passes the credit assessment, the loan is approved. The bank determines the loan amount, interest rate, repayment term, and any associated fees.</p>
            </div>
            <div class="col-lg-5" data-aos="fade-up-left">
              <img src="images/work-img-4.png" alt="" class="img-box">
            </div>
          </div>
        </div>
      </div>
      <div class="mt-100" id="faq" data-aos="fade-up">
        <div class="container">
          <div class="service-title">FAQ</div>
          <div class="accordion mt-50" id="faqAccordion">
            <!-- FAQs will be loaded dynamically -->
          </div>
          <div class="text-center mt-4" id="faqLoading">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
          </div>
        </div>
      </div>
      <div class="service-bg mt-100" id="aboutus">
        <div class="container">
          <div class="row justify-content-between align-items-center mobile-row">
            <div class="col-lg-4 col-md-6" data-aos="fade-up-right">
              <h3 class="works-text">About us</h3>
              <img src="images/about-us.png" alt="" class="img-box mt-3">
              <p class="works-subtext mt-3">LoanFlow- Your trusted financial partner for loans. Quick approvals, competitive rates, and personalized solutions to meet your unique needs. Empowering you to achieve your financial goals. Apply online today!</p>
            </div>
            <div class="col-lg-4 col-md-6" data-aos="fade-up-left">
              <div class="about-box">
                <form id="contactForm" action="api/submit-contact.php" method="POST">
                  <div class="form-group">
                    <label for="contact_name" class="form-label">Your Name</label>
                    <input type="text" id="contact_name" name="name" class="form-control" required>
                  </div>
                  <div class="form-group">
                    <label for="contact_phone" class="form-label">Phone number</label>
                    <input type="tel" id="contact_phone" name="phone" class="form-control" required>
                  </div>
                  <div class="form-group">
                    <label for="contact_email" class="form-label">Email address</label>
                    <input type="email" id="contact_email" name="email" class="form-control" required>
                  </div>
                  <div class="form-group">
                    <label for="contact_comment" class="form-label">Comment</label>
                    <textarea id="contact_comment" name="comment" class="form-control" rows="4" placeholder="Please share your questions or comments..."></textarea>
                  </div>
                  <div class="text-center">
                    <button type="submit" class="about-btn">SEND</button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="mt-100" id="testimonials" data-aos="fade-up">
        <div class="container">
          <div class="service-title">What Our Clients Say</div>
          <div class="row mt-50" id="testimonialsContainer">
            <!-- Testimonials will be loaded dynamically -->
          </div>
          <div class="text-center mt-4" id="testimonialsLoading">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Footer Placeholder -->
    <div id="footer-placeholder"></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    window.onscroll = function() {
        var navbar = document.querySelector('.navbar');
        
        if (window.scrollY > 100) {
            navbar.classList.add('scrolled');
        } else {
            navbar.classList.remove('scrolled');
        }
    };
  </script>
  <script src="animation/aos.js"></script>
  <script>
    AOS.init(({
      duration: 1000,
    }))
    
    // Load footer content dynamically
    function loadFooter() {
        let isFileProtocol = window.location.protocol === 'file:';
        
        if (isFileProtocol) {
            // For file:// protocol, show a message about CORS limitations
            document.getElementById('footer-placeholder').innerHTML = `
                <div class="container text-center py-5">
                    <div class="alert alert-warning">
                        <h5>Footer Loading Limited</h5>
                        <p>When accessing via file:// protocol, the footer cannot load due to browser security restrictions (CORS).</p>
                        <p><strong>To see the complete website with footer:</strong></p>
                        <p>Please use: <code>http://localhost:8000/index.html</code></p>
                    </div>
                </div>
            `;
            return;
        }
        
        fetch('footer.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('footer-placeholder').innerHTML = data;
            })
            .catch(error => console.error('Error loading footer:', error));
    }
    
    // Footer will be loaded in the main DOMContentLoaded event listener
  </script>
  
  <script>
    // Load FAQs dynamically
    async function loadFAQs() {
      try {
        console.log('Loading FAQs...');
        let response;
        try {
          // Try PHP API first (for production with database)
          response = await fetch('api/get-content.php?type=faqs&limit=7');
          if (!response.ok) throw new Error('PHP API not available');
          
          // Check if response is actually JSON (not raw PHP code)
          const contentType = response.headers.get('content-type');
          if (!contentType || !contentType.includes('application/json')) {
            throw new Error('PHP server not processing files');
          }
        } catch (error) {
          // Fallback to static JSON (for testing without PHP server)
          console.log('Falling back to static JSON file:', error.message);
          response = await fetch('api/get-content.json');
        }
        console.log('FAQ Response:', response.status, response.ok);
        const data = await response.json();
        console.log('FAQ Data:', data);
        
        const faqContainer = document.getElementById('faqAccordion');
        const loadingElement = document.getElementById('faqLoading');
        
        if (data.success && data.data.length > 0) {
          let faqHTML = '';
          data.data.forEach((faq, index) => {
            const isFirst = index === 0;
            faqHTML += `
              <div class="accordion-item">
                <h2 class="accordion-header" id="heading${index}">
                  <button class="accordion-button ${isFirst ? '' : 'collapsed'}" type="button" data-bs-toggle="collapse" data-bs-target="#collapse${index}" aria-expanded="${isFirst}" aria-controls="collapse${index}">
                    ${faq.question}
                  </button>
                </h2>
                <div id="collapse${index}" class="accordion-collapse collapse ${isFirst ? 'show' : ''}" aria-labelledby="heading${index}" data-bs-parent="#faqAccordion">
                  <div class="accordion-body">
                    <p class="mb-0">${faq.answer}</p>
                  </div>
                </div>
              </div>
            `;
          });
          faqContainer.innerHTML = faqHTML;
        } else {
          faqContainer.innerHTML = '<p class="text-center">No FAQs available at the moment.</p>';
        }
        
        loadingElement.style.display = 'none';
      } catch (error) {
        console.error('Error loading FAQs:', error);
        document.getElementById('faqAccordion').innerHTML = '<p class="text-center text-danger">Error loading FAQs. Please try again later.</p>';
        document.getElementById('faqLoading').style.display = 'none';
      }
    }
    
    // Load Testimonials dynamically
    async function loadTestimonials() {
      try {
        console.log('Loading testimonials...');
        let response;
        let isFileProtocol = window.location.protocol === 'file:';
        
        if (isFileProtocol) {
          // For file:// protocol, show a message about CORS limitations
          console.log('File protocol detected - fetch requests will fail due to CORS');
          throw new Error('File protocol access - please use localhost server for full functionality');
        }
        
        try {
          // Try PHP API first (for production with database)
          response = await fetch('api/get-content.php?type=testimonials&limit=5');
          if (!response.ok) throw new Error('PHP API not available');
          
          // Check if response is actually JSON (not raw PHP code)
          const contentType = response.headers.get('content-type');
          if (!contentType || !contentType.includes('application/json')) {
            throw new Error('PHP server not processing files');
          }
        } catch (error) {
          // Fallback to static JSON (for testing without PHP server)
          console.log('Falling back to static JSON file:', error.message);
          response = await fetch('api/get-testimonials.json');
        }
        console.log('Testimonials Response:', response.status, response.ok);
        const data = await response.json();
        console.log('Testimonials Data:', data);
        
        const testimonialsContainer = document.getElementById('testimonialsContainer');
        const loadingElement = document.getElementById('testimonialsLoading');
        
        if (data.success && data.data.length > 0) {
          let testimonialsHTML = '';
          data.data.forEach((testimonial) => {
            const stars = '★'.repeat(testimonial.rating) + '☆'.repeat(5 - testimonial.rating);
            testimonialsHTML += `
              <div class="col-lg-4 col-md-6 mt-3">
                <div class="service-box h-100">
                  <div class="text-center mb-3">
                    <div class="testimonial-stars" style="color: #ffc107; font-size: 1.2em;">${stars}</div>
                  </div>
                  <p class="testimonial-content" style="font-style: italic; margin-bottom: 1rem;">"${testimonial.content}"</p>
                  <div class="testimonial-author text-center">
                    <h5 class="mb-0" style="color: #2c5aa0;">${testimonial.client_name}</h5>
                    <small class="text-muted">${testimonial.client_position || 'Valued Client'}</small>
                  </div>
                </div>
              </div>
            `;
          });
          testimonialsContainer.innerHTML = testimonialsHTML;
        } else {
          testimonialsContainer.innerHTML = '<div class="col-12"><p class="text-center">No testimonials available at the moment.</p></div>';
        }
        
        loadingElement.style.display = 'none';
      } catch (error) {
        console.error('Error loading testimonials:', error);
        let isFileProtocol = window.location.protocol === 'file:';
        let errorMessage = isFileProtocol ? 
          '<div class="col-12"><div class="alert alert-warning text-center"><h6>Testimonials Loading Limited</h6><p>When accessing via file:// protocol, testimonials cannot load due to browser security restrictions.</p><p><strong>For full functionality, please use:</strong> <code>http://localhost:8000/index.html</code></p></div></div>' :
          '<div class="col-12"><p class="text-center text-danger">Error loading testimonials. Please try again later.</p></div>';
        document.getElementById('testimonialsContainer').innerHTML = errorMessage;
        document.getElementById('testimonialsLoading').style.display = 'none';
      }
    }
    
    // Contact form submission handler
    function handleContactForm() {
      const contactForm = document.getElementById('contactForm');
      if (contactForm) {
        contactForm.addEventListener('submit', function(e) {
          e.preventDefault();
          
          const formData = new FormData(this);
          const submitBtn = this.querySelector('button[type="submit"]');
          const originalText = submitBtn.textContent;
          
          // Show loading state
          submitBtn.textContent = 'SENDING...';
          submitBtn.disabled = true;
          
          fetch('api/submit-contact.php', {
            method: 'POST',
            body: formData
          })
          .then(response => response.json())
          .then(data => {
            if (data.success) {
              // Show success message
              alert('Thank you for contacting us! We have received your message and will respond shortly.');
              // Reset form
              this.reset();
            } else {
              // Show error message
              alert('Error: ' + (data.message || 'Something went wrong. Please try again.'));
            }
          })
          .catch(error => {
            console.error('Contact form error:', error);
            alert('There was an error submitting your message. Please try again or contact us directly.');
          })
          .finally(() => {
            // Restore button state
            submitBtn.textContent = originalText;
            submitBtn.disabled = false;
          });
        });
      }
    }
    
    // Load company settings from admin panel
    async function loadCompanySettings() {
      try {
        const response = await fetch('api/get-company-settings.php');
        const result = await response.json();
        
        if (result.success && result.data) {
          // Update footer contact information
          const addressElement = document.getElementById('company-address');
          const phoneElement = document.getElementById('company-phone');
          const emailElement = document.getElementById('company-email');
          
          if (addressElement) {
            addressElement.innerHTML = result.data.company_address;
          }
          if (phoneElement) {
            phoneElement.textContent = result.data.company_phone;
          }
          if (emailElement) {
            emailElement.textContent = result.data.company_email;
          }
        }
      } catch (error) {
        console.log('Using default company settings:', error.message);
        // Fallback to default values already in HTML
      }
    }
    
    // Load content when page loads
    document.addEventListener('DOMContentLoaded', function() {
      loadFAQs();
      loadTestimonials();
      handleContactForm();
      loadCompanySettings();
      loadFooter();
    });
  </script>

  <!-- Advanced AI Chat Box -->
  <div id="aiChatBox" class="ai-chat-container">
    <div class="chat-header">
      <div class="chat-header-info">
        <div class="chat-avatar">
          <i class="fas fa-robot"></i>
        </div>
        <div class="chat-title">
          <h4>AI Assistant</h4>
          <span class="chat-status" id="chatStatus">Online</span>
        </div>
      </div>
      <div class="chat-controls">
        <button class="chat-minimize" onclick="minimizeChat()">
          <i class="fas fa-minus"></i>
        </button>
        <button class="chat-close" onclick="closeChat()">
          <i class="fas fa-times"></i>
        </button>
      </div>
    </div>
    
    <div class="chat-messages" id="chatMessages">
      <div class="message bot-message">
        <div class="message-avatar">
          <i class="fas fa-robot"></i>
        </div>
        <div class="message-content">
          <p>Hello! I'm your AI assistant. I can help you with questions about our loan services, application process, and more. How can I assist you today?</p>
          <span class="message-time">Just now</span>
        </div>
      </div>
    </div>
    
    <div class="typing-indicator" id="typingIndicator" style="display: none;">
      <div class="typing-dots">
        <span></span>
        <span></span>
        <span></span>
      </div>
      <span>AI is typing...</span>
    </div>
    
    <div class="chat-input-container">
      <div class="chat-input-wrapper">
        <input type="text" id="chatInput" placeholder="Type your message..." maxlength="500">
        <button id="sendButton" onclick="sendMessage()">
          <i class="fas fa-paper-plane"></i>
        </button>
      </div>
      <div class="chat-suggestions">
        <button class="suggestion-btn" onclick="sendSuggestion('How do I apply for a loan?')">Apply for Loan</button>
        <button class="suggestion-btn" onclick="sendSuggestion('What are your interest rates?')">Interest Rates</button>
        <button class="suggestion-btn" onclick="sendSuggestion('How long does approval take?')">Approval Time</button>
      </div>
    </div>
  </div>

  <!-- Chat Toggle Button -->
  <div id="chatToggle" class="chat-toggle" onclick="toggleChat()">
    <i class="fas fa-comments"></i>
    <span class="chat-notification" id="chatNotification" style="display: none;">1</span>
  </div>

  <script>
    // AI Chat Functionality
    let chatOpen = false;
    let conversationHistory = [];
    let isTyping = false;

    function toggleChat() {
      if (chatOpen) {
        closeChat();
      } else {
        openChat();
      }
    }

    function openChat() {
      const chatBox = document.getElementById('aiChatBox');
      const chatToggle = document.getElementById('chatToggle');
      const notification = document.getElementById('chatNotification');
      
      chatBox.style.display = 'flex';
      chatToggle.style.display = 'none';
      notification.style.display = 'none';
      chatOpen = true;
      
      setTimeout(() => {
        document.getElementById('chatInput').focus();
      }, 300);
    }

    function closeChat() {
      const chatBox = document.getElementById('aiChatBox');
      const chatToggle = document.getElementById('chatToggle');
      
      chatBox.style.display = 'none';
      chatToggle.style.display = 'flex';
      chatOpen = false;
    }

    function minimizeChat() {
      closeChat();
    }

    function sendMessage() {
      const input = document.getElementById('chatInput');
      const message = input.value.trim();
      
      if (message && !isTyping) {
        addMessage(message, 'user');
        input.value = '';
        showTypingIndicator();
        sendToAI(message);
      }
    }

    function sendSuggestion(suggestion) {
      const input = document.getElementById('chatInput');
      input.value = suggestion;
      sendMessage();
    }

    function addMessage(content, sender) {
      const messagesContainer = document.getElementById('chatMessages');
      const messageDiv = document.createElement('div');
      messageDiv.className = `message ${sender}-message`;
      
      const currentTime = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
      
      if (sender === 'user') {
        messageDiv.innerHTML = `
          <div class="message-content">
            <p>${escapeHtml(content)}</p>
            <span class="message-time">${currentTime}</span>
          </div>
          <div class="message-avatar">
            <i class="fas fa-user"></i>
          </div>
        `;
      } else {
        messageDiv.innerHTML = `
          <div class="message-avatar">
            <i class="fas fa-robot"></i>
          </div>
          <div class="message-content">
            <p>${content}</p>
            <span class="message-time">${currentTime}</span>
          </div>
        `;
      }
      
      messagesContainer.appendChild(messageDiv);
      messagesContainer.scrollTop = messagesContainer.scrollHeight;
      
      conversationHistory.push({
        role: sender === 'user' ? 'user' : 'assistant',
        content: content
      });
    }

    function showTypingIndicator() {
      const typingIndicator = document.getElementById('typingIndicator');
      typingIndicator.style.display = 'flex';
      isTyping = true;
      
      const messagesContainer = document.getElementById('chatMessages');
      messagesContainer.scrollTop = messagesContainer.scrollHeight;
    }

    function hideTypingIndicator() {
      const typingIndicator = document.getElementById('typingIndicator');
      typingIndicator.style.display = 'none';
      isTyping = false;
    }

    async function sendToAI(message) {
      try {
        const response = await fetch('/api/chatbot.php', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            message: message,
            conversation_history: conversationHistory.slice(-10),
            client_area: false,
            page_context: 'homepage'
          })
        });
        
        const data = await response.json();
        
        hideTypingIndicator();
        
        if (data.success) {
          addMessage(data.response, 'bot');
        } else {
          addMessage('I apologize, but I\'m having trouble processing your request right now. Please try again or contact our support team.', 'bot');
        }
        
      } catch (error) {
        console.error('Chat error:', error);
        hideTypingIndicator();
        addMessage('I\'m experiencing technical difficulties. Please try again later or contact support.', 'bot');
      }
    }

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    // Enter key to send message
    document.getElementById('chatInput').addEventListener('keypress', function(e) {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        sendMessage();
      }
    });
  </script>
</body>
</html>